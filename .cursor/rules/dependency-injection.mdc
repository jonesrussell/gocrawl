---
description: 
globs: 
alwaysApply: true
---
# Dependency Injection & Interfaces

- Define interfaces in the package that uses them, not where they are implemented.
- For module-specific interfaces, define them in module.go.
- For interfaces used across multiple packages, define them in the consuming package.
- Avoid interface stuttering (e.g., use `Logger` instead of `CollectorLogger`).
- Define New* constructors only in module.go files.
- Use unnamed dependencies in constructors (e.g., `NewServer(logger.Interface, config.Interface)` instead of `NewServer(Params)`).
- Use function types for simple interfaces (e.g., `JobValidatorFunc` for `JobValidator`).
- Use `fx.Module` consistently across all modules.
- Keep module.go files focused on DI setup and avoid business logic.
- When testing modules:
  - Provide all required dependencies.
  - Avoid providing dependencies that are already provided.
  - Use test helpers for common dependency setup.
  - Verify dependency injection before testing functionality.

See [dependency injection guidelines](mdc:dependency-injection.mdc) for more details.
